# /test-scaffold

Generate test scaffolding for a Roblox feature using the TestLogger standard.

## Usage

```
/test-scaffold <feature_name> [description]
```

## What This Skill Does

When invoked, generate a complete Luau test script that:
1. Uses the `TestLogger` module for structured output
2. Tests the feature described by the user
3. Includes before/after snapshots where relevant
4. Prints a `[TEST SUMMARY]` at the end

## Instructions

1. Ask the user what feature they want to test if not provided
2. Identify the key instances, properties, and events to verify
3. Generate a test script following the template below
4. The script should be ready to run via `run_test` or `run_code`

## Template

Generate a Luau script following this structure:

```lua
-- {feature_name}-test.luau
-- Tests for: {description}
-- Generated by /test-scaffold

local TestLogger = require(game:GetService("CoreGui"):FindFirstChild("RbxSync").TestLogger)

TestLogger.begin("{feature_name}")

-- Setup: find/create instances needed for testing
-- ...

-- Test 1: Verify initial state
-- TestLogger.assertNotNil("instance_exists", instance)
-- TestLogger.snapshot("initial_state", instance)

-- Test 2: Verify properties
-- TestLogger.assert("property_name", expectedValue, actualValue)

-- Test 3: Verify behavior
-- TestLogger.assertTrue("behavior_check", condition, "description")

-- Test 4: Verify events (if applicable)
-- TestLogger.event("EventName", {args})

-- Cleanup and summary
TestLogger.finish()
```

## Guidelines

- **One test per assertion**: Each `TestLogger.assert/assertTrue/pass/fail` should test ONE thing
- **Descriptive names**: Use `snake_case` names that describe what's being tested (e.g., `door_starts_closed`, `health_decreases_on_hit`)
- **Early exit on dependencies**: If a test depends on a previous assertion (e.g., instance must exist before checking properties), use `if not` guards
- **Snapshots for state changes**: Always snapshot before and after when testing property modifications
- **Keep it simple**: Don't over-engineer â€” test the happy path and the most important edge case

## Example

For `/test-scaffold door_system A door that opens when touched`:

```lua
-- door_system-test.luau
-- Tests for: A door that opens when touched

local Workspace = game:GetService("Workspace")
local TestLogger = require(game:GetService("CoreGui"):FindFirstChild("RbxSync").TestLogger)

TestLogger.begin("door_system")

-- Setup
local door = Workspace:FindFirstChild("Door")
if not TestLogger.assertNotNil("door_exists", door, "Door model in Workspace") then
    TestLogger.finish()
    return
end

local doorPart = door:FindFirstChild("DoorPart")
TestLogger.assertNotNil("door_part_exists", doorPart)

-- Test initial state
if doorPart then
    TestLogger.snapshot("door_closed", doorPart)
    TestLogger.assert("starts_opaque", 0, doorPart.Transparency)
    TestLogger.assertTrue("starts_anchored", doorPart.Anchored)
end

-- Test touch event wiring
local hasTouchConnection = doorPart and doorPart:FindFirstChildWhichIsA("TouchTransmitter") ~= nil
TestLogger.assertTrue("touch_wired", hasTouchConnection, "Touched event should be connected")

-- Test open behavior (simulate by firing BindableEvent if available)
local openEvent = door:FindFirstChild("DoorOpened")
if openEvent and openEvent:IsA("BindableEvent") then
    openEvent:Fire("TestPlayer")
    task.wait(0.2)
    TestLogger.event("DoorOpened", {"TestPlayer"})

    if doorPart then
        TestLogger.snapshot("door_opened", doorPart)
        TestLogger.assert("opens_transparent", 1, doorPart.Transparency)
    end
else
    TestLogger.fail("open_event", "DoorOpened BindableEvent not found")
end

TestLogger.finish()
```
